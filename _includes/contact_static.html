<!-- Ready to Learn More or Get Started? -->
<section id="contact">
  <div class="container">
    <div class="row">
      <div class="col-lg-12 text-center">
        <h2>Ready to Learn More or Get Started?</h2>
        <hr class="star-primary">
      </div>
    </div>

    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 text-center" style="margin-bottom:20px;">
        <a id="toggle-form-btn"
           class="btn btn-primary btn-lg"
           data-toggle="collapse"
           href="#get-started-form"
           aria-expanded="false"
           aria-controls="get-started-form">
          Show Form
        </a>
        <div style="margin-top:10px; font-size:14px;">
          Prefer a new tab?
          <a href="https://form.jotform.com/252365550897165" target="_blank" rel="noopener">Open the form directly</a>.
        </div>
      </div>
    </div>

    <!-- Collapsible form container -->
    <div id="get-started-form" class="collapse">
      <div class="row">
        <div class="col-lg-10 col-lg-offset-1" style="margin-top:20px;">
          <!-- JotForm will be injected here on first open -->
          <div id="jotform-container" style="width:100%;"></div>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
(function () {
  function init() {
    var btn   = document.getElementById('toggle-form-btn');
    var panel = document.getElementById('get-started-form');
    if (!btn || !panel) return;

    var loaded = false;
    function loadJotFormOnce() {
      if (loaded) return;
      var s = document.createElement('script');
      s.src = 'https://form.jotform.com/jsform/252365550897165';
      s.async = true;
      var host = document.getElementById('jotform-container');
      if (host) host.appendChild(s);
      loaded = true;
    }

    function setLabelByState() {
      // BS3 uses "in", BS4/5 uses "show"
      var expanded = panel.classList.contains('in') || panel.classList.contains('show');
      btn.textContent = expanded ? 'Hide Form' : 'Show Form';
      btn.setAttribute('aria-expanded', expanded ? 'true' : 'false');
    }

    // Bind Bootstrap collapse events (after Bootstrap is loaded)
    if (window.jQuery && typeof jQuery.fn.collapse === 'function') {
      jQuery(panel)
        .on('shown.bs.collapse', function () {
          setLabelByState();
          loadJotFormOnce();  // load after panel is visible for correct sizing
        })
        .on('hidden.bs.collapse', function () {
          setLabelByState();
        });
    }

    // Safety: also update label on click in case events are missed
    btn.addEventListener('click', function () {
      // let Bootstrap toggle first, then read state
      setTimeout(setLabelByState, 350);
      setTimeout(loadJotFormOnce, 0);
    });

    // Initial state
    setLabelByState();
  }

  // Run after all assets (jQuery + Bootstrap) are loaded
  if (document.readyState === 'complete') {
    init();
  } else {
    window.addEventListener('load', init);
  }
})();
</script>

